<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="{{ url_for('static', filename='bid.png') }}" type="image/png">
    <title>项目组长管理</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
      @keyframes flash-once {
        0% { opacity: 0; transform: scale(0.9); }
        50% { opacity: 1; transform: scale(1.02); }
        100% { opacity: 1; transform: scale(1); }
      }

      .flash-once {
        animation: flash-once 1s ease-in-out;
        transition: opacity 0.5s ease-out;
      }
    </style>

</head>
<body class="p-5">
    <div class="container">
        <h3 class="mb-4">👥 项目组长管理</h3>
        <a href="{{ url_for('admin_panel') }}" class="btn btn-secondary mb-4">⬅ 返回项目管理</a>
        <!-- ✅ 显示 flash 消息 -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }} flash-once" role="alert">
                {{ message }}
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <!-- 添加组长表单 -->
        <form method="POST" action="{{ url_for('add_leader') }}" class="row g-3 mb-4">
            <div class="col-md-4">
                <input type="text" class="form-control" name="name" placeholder="姓名" required>
            </div>
            <div class="col-md-6">
                <input type="email" class="form-control" name="email" placeholder="邮箱" required>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-success w-100">➕ 添加组长</button>
            </div>
        </form>

        <!-- 组长列表 -->
        <div style="max-height: 700px; overflow-y: auto;">
            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th>序号</th>
                        <th>姓名</th>
                        <th>邮箱</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    {% for leader in leaders %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ leader.name }}</td>
                        <td>{{ leader.email }}</td>
                        <td>
                            <a href="{{ url_for('edit_leader', leader_id=leader.id) }}" class="btn btn-warning btn-sm">✏️ 编辑</a>
                            <form method="POST" action="{{ url_for('delete_leader', leader_id=leader.id) }}" style="display:inline-block;">
                                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('确认删除此组长？')">🗑 删除</button>
                            </form>
                        </td>
                    </tr>
                    {% else %}
                    <tr><td colspan="4" class="text-center">暂无组长信息</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>


<script>
  window.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
      const flashMessages = document.querySelectorAll('.flash-once');
      flashMessages.forEach(msg => {
        msg.style.opacity = '0';
        setTimeout(() => msg.remove(), 500);  // 完全移除
      });
    }, 5000);  // ⏰ 5秒后淡出
  });
</script>

</body>
</html>
